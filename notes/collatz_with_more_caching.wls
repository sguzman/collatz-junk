#!/usr/bin/env wolframscript
(* ::Package:: *)

(* ::Input:: *)
(*1*)


(* ::Input:: *)
(*collatz[1]=1*)
(**)
(*collatz[n_Integer/;And[n>1,OddQ[n]]]:=collatz[n]=3 n+1*)
(*collatz[n_Integer/;And[n>1,EvenQ[n]]]:=collatz[n]=n/2*)
(**)
(*collatzseq[1]={1}*)
(*collatzseq[n_Integer/;n>1]:={n,Splice@colseq@col@n}*)


(* ::Input:: *)
(*collatzseq[27]*)


(* ::Input:: *)
(*ClearSystemCache[]*)


(* ::Input:: *)
(*ClearAll[collatz]*)


(* ::Input:: *)
(*ClearAll[collatzseq]*)


(* ::Input:: *)
(*collatz[1]=1*)
(**)
(*collatz[n_Integer/;And[n>1,OddQ[n]]]:=collatz[n]=3 n+1*)
(*collatz[n_Integer/;And[n>1,EvenQ[n]]]:=collatz[n]=n/2*)
(**)
(*collatzseq[1]={1}*)
(*collatzseq[n_Integer/;n>1]:={n,Splice@collatzseq@collatz@n}*)


(* ::Input:: *)
(*collatzseq[27]*)


(* ::Input:: *)
(*Information[collatzseq]*)


(* ::Input:: *)
(*ClearAll[collatz]*)


(* ::Input:: *)
(*ClearAll[col]*)


(* ::Input:: *)
(*ClearAll[collatzseq]*)


(* ::Input:: *)
(*collatz[1]=1*)
(**)
(*collatz[n_Integer/;And[n>1,OddQ[n]]]:=collatz[n]=3 n+1*)
(*collatz[n_Integer/;And[n>1,EvenQ[n]]]:=collatz[n]=n/2*)
(**)
(*collatzseq[1]={1}*)
(*collatzseq[n_Integer/;n>1]:=collatzseq[n]={n,Splice@collatzseq@collatz@n}*)


(* ::Input:: *)
(*collatzseq[27]*)


(* ::Input:: *)
(*Information[collatzseq]*)


(* ::Input:: *)
(*MemoryInUse[]*)


(* ::Input:: *)
(*MemoryInUse[]*)


(* ::Input:: *)
(*class[n_Integer/;OddQ@n]=o*)


(* ::Input:: *)
(*class[n_Integer/;EvenQ@n]=o*)


(* ::Input:: *)
(*class[n_Integer/;EvenQ@n]=e*)


(* ::Input:: *)
(*Map[class,collatzseq[27]]*)


(* ::Input:: *)
(*Tally[%33]*)


(* ::Input:: *)
(*Tally@Partition[Map[class,collatzseq[27]],2,1]*)


(* ::Input:: *)
(*collatzseq[871]*)


(* ::Input:: *)
(*collatzseq@9780657630*)


(* ::InheritFromParent:: *)
(*{9780657630,4890328815,14670986446,7335493223,22006479670,11003239835,33009719506,16504859753,49514579260,24757289630,12378644815,37135934446,18567967223,55703901670,27851950835,83555852506,41777926253,125333778760,62666889380,31333444690,15666722345,47000167036,23500083518,11750041759,35250125278,17625062639,52875187918,26437593959,79312781878,39656390939,118969172818,59484586409,178453759228,89226879614,44613439807,133840319422,66920159711,200760479134,100380239567,301140718702,150570359351,451711078054,225855539027,677566617082,338783308541,1016349925624,508174962812,254087481406,127043740703,381131222110,190565611055,571696833166,285848416583,857545249750,428772624875,1286317874626,643158937313,1929476811940,964738405970,482369202985,1447107608956,723553804478,361776902239,1085330706718,542665353359,1627996060078,813998030039,2441994090118,1220997045059,3662991135178,1831495567589,5494486702768,2747243351384,1373621675692,686810837846,343405418923,1030216256770,515108128385,1545324385156,772662192578,386331096289,1158993288868,579496644434,289748322217,869244966652,434622483326,217311241663,651933724990,325966862495,977900587486,488950293743,1466850881230,733425440615,2200276321846,1100138160923,3300414482770,1650207241385,4950621724156,2475310862078,1237655431039,3712966293118,1856483146559,5569449439678,2784724719839,8354174159518,4177087079759,12531261239278,6265630619639,18796891858918,9398445929459,28195337788378,14097668894189,42293006682568,21146503341284,10573251670642,5286625835321,15859877505964,7929938752982,3964969376491,11894908129474,5947454064737,17842362194212,8921181097106,4460590548553,13381771645660,6690885822830,3345442911415,10036328734246,5018164367123,15054493101370,7527246550685,22581739652056,11290869826028,5645434913014,2822717456507,8468152369522,4234076184761,12702228554284,6351114277142,3175557138571,9526671415714,4763335707857,14290007123572,7145003561786,3572501780893,10717505342680,5358752671340,2679376335670,1339688167835,4019064503506,2009532251753,6028596755260,3014298377630,1507149188815,4521447566446,2260723783223,6782171349670,3391085674835,10173257024506,5086628512253,15259885536760,7629942768380,3814971384190,1907485692095,5722457076286,2861228538143,8583685614430,4291842807215,12875528421646,6437764210823,19313292632470,9656646316235,28969938948706,14484969474353,43454908423060,21727454211530,10863727105765,32591181317296,16295590658648,8147795329324,4073897664662,2036948832331,6110846496994,3055423248497,9166269745492,4583134872746,2291567436373,6874702309120,3437351154560,1718675577280,859337788640,429668894320,214834447160,107417223580,53708611790,26854305895,80562917686,40281458843,120844376530,60422188265,181266564796,90633282398,45316641199,135949923598,67974961799,203924885398,101962442699,305887328098,152943664049,458830992148,229415496074,114707748037,344123244112,172061622056,86030811028,43015405514,21507702757,64523108272,32261554136,16130777068,8065388534,4032694267,12098082802,6049041401,18147124204,9073562102,4536781051,13610343154,6805171577,20415514732,10207757366,5103878683,15311636050,7655818025,22967454076,11483727038,5741863519,17225590558,8612795279,25838385838,12919192919,38757578758,19378789379,58136368138,29068184069,87204552208,43602276104,21801138052,10900569026,5450284513,16350853540,8175426770,4087713385,12263140156,6131570078,3065785039,9197355118,4598677559,13796032678,6898016339,20694049018,10347024509,31041073528,15520536764,7760268382,3880134191,11640402574,5820201287,17460603862,8730301931,26190905794,13095452897,39286358692,19643179346,9821589673,29464769020,14732384510,7366192255,22098576766,11049288383,33147865150,16573932575,49721797726,24860898863,74582696590,37291348295,111874044886,55937022443,167811067330,83905533665,251716600996,125858300498,62929150249,188787450748,94393725374,47196862687,141590588062,70795294031,212385882094,106192941047,318578823142,159289411571,477868234714,238934117357,716802352072,358401176036,179200588018,89600294009,268800882028,134400441014,67200220507,201600661522,100800330761,302400992284,151200496142,75600248071,226800744214,113400372107,340201116322,170100558161,510301674484,255150837242,127575418621,382726255864,191363127932,95681563966,47840781983,143522345950,71761172975,215283518926,107641759463,322925278390,161462639195,484387917586,242193958793,726581876380,363290938190,181645469095,544936407286,272468203643,817404610930,408702305465,1226106916396,613053458198,306526729099,919580187298,459790093649,1379370280948,689685140474,344842570237,1034527710712,517263855356,258631927678,129315963839,387947891518,193973945759,581921837278,290960918639,872882755918,436441377959,1309324133878,654662066939,1963986200818,981993100409,2945979301228,1472989650614,736494825307,2209484475922,1104742237961,3314226713884,1657113356942,828556678471,2485670035414,1242835017707,3728505053122,1864252526561,5592757579684,2796378789842,1398189394921,4194568184764,2097284092382,1048642046191,3145926138574,1572963069287,4718889207862,2359444603931,7078333811794,3539166905897,10617500717692,5308750358846,2654375179423,7963125538270,3981562769135,11944688307406,5972344153703,17917032461110,8958516230555,26875548691666,13437774345833,40313323037500,20156661518750,10078330759375,30234992278126,15117496139063,45352488417190,22676244208595,68028732625786,34014366312893,102043098938680,51021549469340,25510774734670,12755387367335,38266162102006,19133081051003,57399243153010,28699621576505,86098864729516,43049432364758,21524716182379,64574148547138,32287074273569,96861222820708,48430611410354,24215305705177,72645917115532,36322958557766,18161479278883,54484437836650,27242218918325,81726656754976,40863328377488,20431664188744,10215832094372,5107916047186,2553958023593,7661874070780,3830937035390,1915468517695,5746405553086,2873202776543,8619608329630,4309804164815,12929412494446,6464706247223,19394118741670,9697059370835,29091178112506,14545589056253,43636767168760,21818383584380,10909191792190,5454595896095,16363787688286,8181893844143,24545681532430,12272840766215,36818522298646,18409261149323,55227783447970,27613891723985,82841675171956,41420837585978,20710418792989,62131256378968,31065628189484,15532814094742,7766407047371,23299221142114,11649610571057,34948831713172,17474415856586,8737207928293,26211623784880,13105811892440,6552905946220,3276452973110,1638226486555,4914679459666,2457339729833,7372019189500,3686009594750,1843004797375,5529014392126,2764507196063,8293521588190,4146760794095,12440282382286,6220141191143,18660423573430,9330211786715,27990635360146,13995317680073,41985953040220,20992976520110,10496488260055,31489464780166,15744732390083,47234197170250,23617098585125,70851295755376,35425647877688,17712823938844,8856411969422,4428205984711,13284617954134,6642308977067,19926926931202,9963463465601,29890390396804,14945195198402,7472597599201,22417792797604,11208896398802,5604448199401,16813344598204,8406672299102,4203336149551,12610008448654,6305004224327,18915012672982,9457506336491,28372519009474,14186259504737,42558778514212,21279389257106,10639694628553,31919083885660,15959541942830,7979770971415,23939312914246,11969656457123,35908969371370,17954484685685,53863454057056,26931727028528,13465863514264,6732931757132,3366465878566,1683232939283,5049698817850,2524849408925,7574548226776,3787274113388,1893637056694,946818528347,2840455585042,1420227792521,4260683377564,2130341688782,1065170844391,3195512533174,1597756266587,4793268799762,2396634399881,7189903199644,3594951599822,1797475799911,5392427399734,2696213699867,8088641099602,4044320549801,12132961649404,6066480824702,3033240412351,9099721237054,4549860618527,13649581855582,6824790927791,20474372783374,10237186391687,30711559175062,15355779587531,46067338762594,23033669381297,69101008143892,34550504071946,17275252035973,51825756107920,25912878053960,12956439026980,6478219513490,3239109756745,9717329270236,4858664635118,2429332317559,7287996952678,3643998476339,10931995429018,5465997714509,16397993143528,8198996571764,4099498285882,2049749142941,6149247428824,3074623714412,1537311857206,768655928603,2305967785810,1152983892905,3458951678716,1729475839358,864737919679,2594213759038,1297106879519,3891320638558,1945660319279,5836980957838,2918490478919,8755471436758,4377735718379,13133207155138,6566603577569,19699810732708,9849905366354,4924952683177,14774858049532,7387429024766,3693714512383,11081143537150,5540571768575,16621715305726,8310857652863,24932572958590,12466286479295,37398859437886,18699429718943,56098289156830,28049144578415,84147433735246,42073716867623,126221150602870,63110575301435,189331725904306,94665862952153,283997588856460,141998794428230,70999397214115,212998191642346,106499095821173,319497287463520,159748643731760,79874321865880,39937160932940,19968580466470,9984290233235,29952870699706,14976435349853,44929306049560,22464653024780,11232326512390,5616163256195,16848489768586,8424244884293,25272734652880,12636367326440,6318183663220,3159091831610,1579545915805,4738637747416,2369318873708,1184659436854,592329718427,1776989155282,888494577641,2665483732924,1332741866462,666370933231,1999112799694,999556399847,2998669199542,1499334599771,4498003799314,2249001899657,6747005698972,3373502849486,1686751424743,5060254274230,2530127137115,7590381411346,3795190705673,11385572117020,5692786058510,2846393029255,8539179087766,4269589543883,12808768631650,6404384315825,19213152947476,9606576473738,4803288236869,14409864710608,7204932355304,3602466177652,1801233088826,900616544413,2701849633240,1350924816620,675462408310,337731204155,1013193612466,506596806233,1519790418700,759895209350,379947604675,1139842814026,569921407013,1709764221040,854882110520,427441055260,213720527630,106860263815,320580791446,160290395723,480871187170,240435593585,721306780756,360653390378,180326695189,540980085568,270490042784,135245021392,67622510696,33811255348,16905627674,8452813837,25358441512,12679220756,6339610378,3169805189,9509415568,4754707784,2377353892,1188676946,594338473,1783015420,891507710,445753855,1337261566,668630783,2005892350,1002946175,3008838526,1504419263,4513257790,2256628895,6769886686,3384943343,10154830030,5077415015,15232245046,7616122523,22848367570,11424183785,34272551356,17136275678,8568137839,25704413518,12852206759,38556620278,19278310139,57834930418,28917465209,86752395628,43376197814,21688098907,65064296722,32532148361,97596445084,48798222542,24399111271,73197333814,36598666907,109796000722,54898000361,164694001084,82347000542,41173500271,123520500814,61760250407,185280751222,92640375611,277921126834,138960563417,416881690252,208440845126,104220422563,312661267690,156330633845,468991901536,234495950768,117247975384,58623987692,29311993846,14655996923,43967990770,21983995385,65951986156,32975993078,16487996539,49463989618,24731994809,74195984428,37097992214,18548996107,55646988322,27823494161,83470482484,41735241242,20867620621,62602861864,31301430932,15650715466,7825357733,23476073200,11738036600,5869018300,2934509150,1467254575,4401763726,2200881863,6602645590,3301322795,9903968386,4951984193,14855952580,7427976290,3713988145,11141964436,5570982218,2785491109,8356473328,4178236664,2089118332,1044559166,522279583,1566838750,783419375,2350258126,1175129063,3525387190,1762693595,5288080786,2644040393,7932121180,3966060590,1983030295,5949090886,2974545443,8923636330,4461818165,13385454496,6692727248,3346363624,1673181812,836590906,418295453,1254886360,627443180,313721590,156860795,470582386,235291193,705873580,352936790,176468395,529405186,264702593,794107780,397053890,198526945,595580836,297790418,148895209,446685628,223342814,111671407,335014222,167507111,502521334,251260667,753782002,376891001,1130673004,565336502,282668251,848004754,424002377,1272007132,636003566,318001783,954005350,477002675,1431008026,715504013,2146512040,1073256020,536628010,268314005,804942016,402471008,201235504,100617752,50308876,25154438,12577219,37731658,18865829,56597488,28298744,14149372,7074686,3537343,10612030,5306015,15918046,7959023,23877070,11938535,35815606,17907803,53723410,26861705,80585116,40292558,20146279,60438838,30219419,90658258,45329129,135987388,67993694,33996847,101990542,50995271,152985814,76492907,229478722,114739361,344218084,172109042,86054521,258163564,129081782,64540891,193622674,96811337,290434012,145217006,72608503,217825510,108912755,326738266,163369133,490107400,245053700,122526850,61263425,183790276,91895138,45947569,137842708,68921354,34460677,103382032,51691016,25845508,12922754,6461377,19384132,9692066,4846033,14538100,7269050,3634525,10903576,5451788,2725894,1362947,4088842,2044421,6133264,3066632,1533316,766658,383329,1149988,574994,287497,862492,431246,215623,646870,323435,970306,485153,1455460,727730,363865,1091596,545798,272899,818698,409349,1228048,614024,307012,153506,76753,230260,115130,57565,172696,86348,43174,21587,64762,32381,97144,48572,24286,12143,Splice[collatzseq[collatz[12143]]]}*)


(* ::Input:: *)
(*Block[{$RecursionLimit=Infinity},*)
(*%%*)
(*]*)


(* ::Input:: *)
(*Block[{$RecursionLimit=Infinity},*)
(*collatzseq@9780657630*)
(*]*)


(* ::Input:: *)
(*MemoryInUse[]*)


(* ::Input:: *)
(**)


(* ::Input:: *)
(*collatzseq@9780657630;*)


(* ::Input:: *)
(*Tally@*)
(*Map[class,collatzseq@9780657630]*)


(* ::InheritFromParent:: *)
(*{{e,633},{o,388},{class[Splice[collatzseq[collatz[12143]]]],1}}*)


(* ::Input:: *)
(*collatzseq[12143]*)


(* ::Input:: *)
(*Block[{$RecursionLimit=Infinity},*)
(*collatzseq[12143]*)
(*]*)


(* ::Input:: *)
(*collatzseq=.*)


(* ::Input:: *)
(*Information[collatzseq]*)


(* ::Input:: *)
(*collatzseq[_]=.*)


(* ::Input:: *)
(*collatzseq[x_]=.*)


(* ::Input:: *)
(*Clear*)
